<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml"
	  xmlns="http://www.w3.org/1999/html">

  <head>
    <title>ORGANIC</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,500,600,700,800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700,700i&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Amatic+SC:400,700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/single/css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="/single/css/animate.css">
    
    <link rel="stylesheet" href="/single/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/single/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="/single/css/magnific-popup.css">

    <link rel="stylesheet" href="/single/css/aos.css">

    <link rel="stylesheet" href="/single/css/ionicons.min.css">

    <link rel="stylesheet" href="/single/css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="/single/css/jquery.timepicker.css">

    
    <link rel="stylesheet" href="/single/css/flaticon.css">
    <link rel="stylesheet" href="/single/css/icomoon.css">
<!--    <link rel="stylesheet" href="/single/css/style.css">-->

	  <!-- Google Web Fonts -->
	  <link rel="preconnect" href="https://fonts.googleapis.com">
	  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500&family=Lora:wght@600;700&display=swap" rel="stylesheet">

	  <!-- Icon Font Stylesheet -->
	  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
	  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

	  <!-- Libraries Stylesheet -->
	  <link href="/lib/animate/animate.min.css" rel="stylesheet">
	  <link href="/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

	  <!-- Customized Bootstrap Stylesheet -->
	  <link href="/css/bootstrap.min.css" rel="stylesheet">

	  <!-- Template Stylesheet -->
	  <link href="/css/style.css" rel="stylesheet">
  </head>
  <body class="goto-here">
  <!-- Navbar Start -->
  <div class="container-fluid bg-light fixed-top px-0 wow fadeIn" data-wow-delay="0.1s">
	  <div class="top-bar row gx-0 align-items-center d-none d-lg-flex">
		  <div class="col-lg-6 px-5 text-start">
			  <small><i class="fa fa-map-marker-alt me-2"></i>123 Street, New York, USA</small>
			  <small class="ms-4"><i class="fa fa-envelope me-2"></i>info@example.com</small>
		  </div>
		  <div class="col-lg-6 px-5 text-end">
			  <small>Follow us:</small>
			  <a class="text-body ms-3" href=""><i class="fab fa-facebook-f"></i></a>
			  <a class="text-body ms-3" href=""><i class="fab fa-twitter"></i></a>
			  <a class="text-body ms-3" href=""><i class="fab fa-linkedin-in"></i></a>
			  <a class="text-body ms-3" href=""><i class="fab fa-instagram"></i></a>
		  </div>
	  </div>

	  <nav class="navbar navbar-expand-lg navbar-light py-lg-0 px-lg-5   wow fadeIn"  data-wow-delay="0.1s">
		  <a href="index.html" class="navbar-brand ms-4 ms-lg-0">
			  <h1 class="fw-bold text-primary m-0">OR<span class="text-secondary">GAN</span>IC</h1>
		  </a>
		  <button type="button" class="navbar-toggler me-4" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
			  <span class="navbar-toggler-icon"></span>
		  </button>
		  <div class="collapse navbar-collapse" id="navbarCollapse">
			  <div class="navbar-nav ms-auto p-4 p-lg-0">
				  <a th:href="@{/}" class="nav-item nav-link">Home</a>

				  <a th:href="@{/user/products}" class="nav-item nav-link active">Products</a>
				  <div class="nav-item dropdown">
					  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">Pages</a>
					  <div class="dropdown-menu m-0">
						  <a href="blog.html" class="dropdown-item">Blog Grid</a>
						  <a href="feature.html" class="dropdown-item">Our Features</a>
						  <a th:href="@{/logout}" sec:authorize="isAuthenticated()" class="dropdown-item">Logout</a>
						  <a href="404.html" class="dropdown-item">404 Page</a>
					  </div>
				  </div>
				  <a href="contact.html" class="nav-item nav-link">Contact Us</a>
			  </div>
			  <div class="d-none d-lg-flex ms-2">
				  <a class="btn-sm-square bg-white rounded-circle ms-3" href="">
					  <small class="fa fa-search text-body"></small>
				  </a>
				  <a class="btn-sm-square bg-white rounded-circle ms-3" href="">
					  <small class="fa fa-user text-body"></small>
				  </a>
				  <a class="btn-sm-square bg-white rounded-circle ms-3" href="">
					  <small class="fa fa-shopping-bag text-body"></small>
				  </a>
			  </div>
		  </div>
	  </nav>
  </div>
  <!-- Navbar End -->




    <div class="hero-wrap hero-bread"  style="background-image: url('images/bg_1.jpg'); margin-top: 9rem;">
      <div class="container">
        <div class="row no-gutters slider-text align-items-center justify-content-center">
          <div class="col-md-9 ftco-animate text-center">
<!--          	<p class="breadcrumbs"><span class="mr-2"><a href="index.html">Home</a></span> <span>Cart</span></p>-->
            <h1 class="mb-0 bread">My Cart</h1>
          </div>
        </div>
      </div>
    </div>

    <section class="ftco-section ftco-cart">
<div class="container">
	<div class="row">
		<div class="col-md-12 ftco-animate">
			<div class="cart-list">
						<table class="table">
							<thead>
							<tr>
								<th>       </th>
								<th>Product</th>
								<th>Price</th>
								<th>Quantity</th>
								<th>Total</th>
							</tr>
							</thead>
							<tbody>
							<tr th:each="cartItem : ${cartItems}">
								<td><img style="width:56px; height:56px;" th:src="${cartItem.product.productImages}" /></td>
								<td th:text="${cartItem.product.productName}"></td>
								<td th:text="${cartItem.price}"></td>

								<td>
<!--									&lt;!&ndash; Decrement Button &ndash;&gt;-->
<!--									<button th:onclick="'changeQtyM(\'' + ${cartItem.cartItemId} + '\')'">-</button>-->


<!--									&lt;!&ndash; Quantity Display &ndash;&gt;-->
<!--									<span th:id="'quantity' + ${cartItem.cartItemId}" th:text="${cartItem.quantity}"></span>-->

<!--									&lt;!&ndash; Increment Button &ndash;&gt;-->
<!--									<button th:onclick="'changeQtyP(\'' + ${cartItem.cartItemId} + '\')'">+</button>-->

									<!-- Decrement Button -->
									<button class="change-quantity" data-cart-item-id="${cartItem.cartItemId}" data-quantity-change="-1">-</button>
									<!-- Quantity Display -->
									<span th:id="'quantity' + ${cartItem.cartItemId}" th:text="${cartItem.quantity}"></span>
									<!-- Increment Button -->
									<button class="change-quantity" data-cart-item-id="${cartItem.cartItemId}" data-quantity-change="1">+</button>
								</td>

								<td th:id="'TotalPrice' + ${cartItem.cartItemId}" name="Total" th:text="'$ ' + (${cartItem.quantity} * ${cartItem.price})"></td>

								<td><form th:action="@{'/deleteCartItem/'+${cartItem.cartItemId}}" th:method="get">
										<button type="submit">Delete</button>
									</form>
									<span id="cartMessage" style="color: red;"></span>
								</td>
							</tr>


							</tbody>
						</table>

				<div class="cart-total mb-3">
					<!-- Subtotal -->
					<p class="d-flex">
						<span>Subtotal</span>
						<span  id="totalSubAmount" th:text="'$ '+${totalPrice}" >0.00</span>
					</p>
					<p class="d-flex">
						<span>Delivery</span>
						<span>$0.00</span>
					</p>
					<p class="d-flex">
						<span>Discount</span>
						<span>$0.00</span>
					</p>

					<hr>
					<!-- Total -->
					<p class="d-flex total-price">
						<span>Total</span>
						<span id="totalAmount" th:text="'$ '+${totalPrice}">0.00</span>
					</p>
				</div>

				<p><a th:href="@{/checkOut}" class="btn btn-primary py-3 px-4">Proceed to Checkout</a></p>
    				</div>
				</div>
			</div>
		</div>
	</div>
</div>
</section>


  <!-- Footer Start -->
  <div class="container-fluid bg-dark footer mt-5 pt-5 wow fadeIn" data-wow-delay="0.1s">
	  <div class="container py-5">
		  <div class="row g-5">
			  <div class="col-lg-3 col-md-6">
				  <h1 class="fw-bold text-primary mb-4">OR<span class="text-secondary">GAN</span>IC</h1>
				  <p>Diam dolor diam ipsum sit. Aliqu diam amet diam et eos. Clita erat ipsum et lorem et sit, sed stet lorem sit clita</p>
				  <div class="d-flex pt-2">
					  <a class="btn btn-square btn-outline-light rounded-circle me-1" href=""><i class="fab fa-twitter"></i></a>
					  <a class="btn btn-square btn-outline-light rounded-circle me-1" href=""><i class="fab fa-facebook-f"></i></a>
					  <a class="btn btn-square btn-outline-light rounded-circle me-1" href=""><i class="fab fa-youtube"></i></a>
					  <a class="btn btn-square btn-outline-light rounded-circle me-0" href=""><i class="fab fa-linkedin-in"></i></a>
				  </div>
			  </div>
			  <div class="col-lg-3 col-md-6">
				  <h4 class="text-light mb-4">Address</h4>
				  <p><i class="fa fa-map-marker-alt me-3"></i>Kinfra, calicute</p>
				  <p><i class="fa fa-phone-alt me-3"></i>+012 345 67890</p>
				  <p><i class="fa fa-envelope me-3"></i>organic@gmail.com</p>
			  </div>
			  <div class="col-lg-3 col-md-6">
				  <h4 class="text-light mb-4">Quick Links</h4>
				  <a class="btn btn-link" href="">About Us</a>
				  <a class="btn btn-link" href="">Contact Us</a>
				  <a class="btn btn-link" href="">Our Services</a>
				  <a class="btn btn-link" href="">Terms & Condition</a>
				  <a class="btn btn-link" href="">Support</a>
			  </div>
			  <div class="col-lg-3 col-md-6">
				  <h4 class="text-light mb-4">Newsletter</h4>
				  <p>Dolor amet sit justo amet elitr clita ipsum elitr est.</p>
				  <div class="position-relative mx-auto" style="max-width: 400px;">
					  <input class="form-control bg-transparent w-100 py-3 ps-4 pe-5" type="text" placeholder="Your email">
					  <button type="button" class="btn btn-primary py-2 position-absolute top-0 end-0 mt-2 me-2" th:href="@{/register.html}">SignUp</button>
				  </div>
			  </div>
		  </div>
	  </div>
	  <div class="container-fluid copyright">
		  <div class="container">
			  <div class="row">
				  <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
					  &copy; <a href="#">Your Site Name</a>, All Right Reserved.
				  </div>
				  <div class="col-md-6 text-center text-md-end">
					  <!--/*** This template is free as long as you keep the footer author’s credit link/attribution link/backlink. If you'd like to use the template without the footer author’s credit link/attribution link/backlink, you can purchase the Credit Removal License from "https://htmlcodex.com/credit-removal". Thank you for your support. ***/-->
					  Designed By <a href="https://htmlcodex.com">HTML Codex</a>
					  <br>Distributed By: <a href="https://themewagon.com" target="_blank">ThemeWagon</a>
				  </div>
			  </div>
		  </div>
	  </div>
  </div>
  <!-- Footer End -->
<!--  <script>-->
<!--	  function changeQtyP(cartItemId) {-->

<!--          let quantityInput = document.getElementById('quantity' + cartItemId);-->
<!--          console.log(quantityInput);-->
<!--          let TotalPrice = document.getElementById('TotalPrice' + cartItemId);-->
<!--          console.log(TotalPrice);-->
<!--		  let OgPrice = parseFloat(document.getElementById('Price' + cartItemId).innerHTML);-->
<!--          console.log(OgPrice);-->
<!--          let totalSubAmount = document.getElementById('totalSubAmount')-->
<!--          console.log(totalSubAmount);-->
<!--          let productQuantity = document.getElementById('productQuantity' + cartItemId).innerHTML;-->
<!--          console.log(productQuantity);-->
<!--          let currentQuantity = parseInt(quantityInput.value);-->
<!--          if (currentQuantity + 1 > productQuantity) {-->
<!--              Swal.fire('Quantity cannot exceed the available product quantity!')-->
<!--              return;-->
<!--          }-->


<!--          $.ajax({-->
<!--              url: '/updateQuantity',-->
<!--              method: 'post',-->
<!--              data: { count: 1, id:cartItemId },-->
<!--              success: (response) => {-->
<!--                  var responseData = JSON.parse(response);-->


<!--                  quantityInput.value = responseData.updatedQuantity;-->

<!--                  TotalPrice.innerHTML = '$' + (OgPrice * responseData.updatedQuantity).toFixed(2);-->

<!--                  totalSubAmount.innerHTML = '$' + responseData.totalPrice;-->

<!--              }-->
<!--          });-->
<!--      }-->


<!--      function changeQtyM(cartItemId) {-->
<!--          let quantityInput = document.getElementById('quantity' + cartItemId);-->
<!--          let TotalPrice = document.getElementById('Totalprice' + cartItemId);-->
<!--          let totalSubAmount = document.getElementById('totalSubAmount')-->
<!--          let OgPrice = parseFloat(document.getElementById('price' + cartItemId).innerHTML);-->

<!--          $.ajax({-->
<!--              url: '/updateQuantity',-->
<!--              method: 'post',-->
<!--              data: { count: -1, id:cartItemId },-->
<!--              success: (response) => {-->
<!--                  var responseData = JSON.parse(response);-->


<!--                  quantityInput.value = responseData.updatedQuantity;-->

<!--                  TotalPrice.innerHTML = '$' + (OgPrice * responseData.updatedQuantity).toFixed(2);-->

<!--                  totalSubAmount.innerHTML = '$' + responseData.totalPrice;-->

<!--              }-->
<!--          });-->
<!--      }-->


<!--  </script>-->
<!--  <script >-->

<!--	  function changeQtyP(cartItemId){-->
<!--	  alert("jui")-->
<!--      let quantityInput = document.getElementById('quantity'+cartItemId)-->
<!--      let totalAmount = document.getElementById('totalAmount')-->
<!--      let totalSubAmount = document.getElementById('totalSubAmount')-->

<!--      let TotalPrice = document.getElementById('Totalprice'+cartItemId)-->
<!--      let OgPrice = document.getElementById('price'+cartItemId).innerHTML-->

<!--          if (Number(quantityInput.value) < 5) {-->
<!--          $.ajax({-->
<!--                url:'/incrementQuantity',-->
<!--                    method:'post',-->
<!--                data:{cartItemId},-->
<!--                success:(response)=>{-->
<!--         var responseData = JSON.parse(response);-->
<!--         if(response){-->
<!--         // Update the quantity and total price on the page-->
<!--         quantityInput.value = response;-->
<!--         console.log(responseData.updatedQuantity)-->
<!--         TotalPrice.innerHTML = '$ ' + (Number(OgPrice) * responseData.updatedQuantity)+'.0';-->
<!--          totalAmount.innerHTML = '$' + responseData.totalPrice+'.0';-->
<!--           totalSubAmount.innerHTML = '$' + responseData.totalPrice+'.0';-->
<!--             }-->
<!--             else{-->
<!--                 showAlertOutOfStock()-->
<!--             }-->

<!--                    }-->
<!--          })-->
<!--           }-->
<!--           }-->

<!--              function showAlertOutOfStock() {-->
<!--             console.log("alert fun called...");-->
<!--             $("#cartAlertOutOfStock").fadeIn();-->

<!--             // Hide the alert box after 5 seconds-->
<!--             setTimeout(function () {-->
<!--                 $("#cartAlertOutOfStock").fadeOut();-->
<!--             }, 3000);-->
<!--         }-->

<!--     function changeQtyM(cartItemId){-->
<!--     let quantityInput = document.getElementById('quantity'+cartItemId)-->
<!--     let totalAmount = document.getElementById('totalAmount')-->
<!--      let totalSubAmount = document.getElementById('totalSubAmount')-->
<!--     let TotalPrice = document.getElementById('Totalprice'+cartItemId)-->
<!--      let OgPrice = document.getElementById('price'+cartItemId).innerHTML-->
<!--      if(Number(quantityInput.value)>1){-->
<!--          $.ajax({-->
<!--                url:'/updateQuantity',-->
<!--                    method:'post',-->
<!--                data:{count:-1,productId},-->
<!--                success:(response)=>{-->

<!--          var responseData = JSON.parse(response);-->

<!--         // Update the quantity and total price on the page-->
<!--         quantityInput.value = responseData.updatedQuantity;-->
<!--         console.log(responseData.updatedQuantity)-->
<!--         TotalPrice.innerHTML = '$ ' + (Number(OgPrice) * responseData.updatedQuantity)+'.0';-->
<!--         totalAmount.innerHTML = '$' + responseData.totalPrice+'.0';-->
<!--          totalSubAmount.innerHTML = '$' + responseData.totalPrice+'.0';-->
<!--                    }-->
<!--          })-->
<!--           }-->
<!--     }-->
<!--  </script>-->

<!--  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>-->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!--  <script>-->
<!--	  $('.change-quantity').click(function() {-->
<!--      var cartItemId = $(this).data('cart-item-id');-->
<!--      var quantityChange = $(this).data('quantity-change');-->
<!--      changeQty(cartItemId, quantityChange);-->
<!--  });-->

<!--	  function changeQty(cartItemId, quantityChange) {-->
<!--	  console.log(cartItemId);-->

<!--          $.ajax({-->
<!--              type: 'POST',-->
<!--              url: '/updateCartItemQuantity/' + cartItemId,-->
<!--              data: {-->
<!--                 cartItemId:cartItemId,-->
<!--                  quantityChange: quantityChange-->
<!--              },-->
<!--              success: function(response) {-->
<!--                console.log("hi");-->
<!--                  if (response.success) {-->
<!--                      // Update the quantity display and total price for the item-->
<!--                      $('#quantity' + cartItemId).text(response.updatedQuantity);-->
<!--                      $('#TotalPrice' + cartItemId).text('$ ' + response.updatedTotalPrice);-->

<!--                      // Update the sub-total and total amounts-->
<!--                      $('#subTotal').text('$ ' + response.subTotal);-->
<!--                      $('#totalAmount').text('$ ' + response.totalAmount);-->

<!--                      // Display success message-->
<!--                      $('#cartMessage').text('Quantity updated successfully');-->
<!--                  } else {-->
<!--                      // Display an error message-->
<!--                      $('#cartMessage').text('Error updating quantity');-->
<!--                  }-->
<!--              }-->
<!--          });-->
<!--      }-->

<!--      // Example for decrement button-->
<!--      $('#decrementButton').click(function() {-->
<!--          var cartItemId = $(this).data('cartItemId');-->
<!--          changeQty(cartItemId, -1); // Decrease quantity by 1-->
<!--      });-->

<!--      // Example for increment button-->
<!--      $('#incrementButton').click(function() {-->
<!--          var cartItemId = $(this).data('cartItemId');-->
<!--          changeQty(cartItemId, 1); // Increase quantity by 1-->
<!--      });-->
<!--  </script>-->
  <script>
	  $(document).ready(function() {

          $('.change-quantity').click(function() {
              var cartItemId = $(this).data('cart-item-id');
              var quantityChange = $(this).data('quantity-change');
              changeQty(cartItemId, quantityChange);
          });

          function changeQty(cartItemId, quantityChange) {
              $.ajax({
                  type: 'POST',
                  url: '/updateCartItemQuantity/' + cartItemId,
                  data: {
                      cartItemId: cartItemId,
                      quantityChange: quantityChange
                  },
                  success: function(response) {
                      if (response.success) {
                          // Update the quantity display and total price for the item
                          $('#quantity' + cartItemId).text(response.updatedQuantity);
                          $('#TotalPrice' + cartItemId).text('$ ' + response.updatedTotalPrice);

                          // Update the sub-total and total amounts
                          $('#subTotal').text('$ ' + response.subTotal);
                          $('#totalAmount').text('$ ' + response.totalAmount);

                          // Display success message
                          $('#cartMessage').text('Quantity updated successfully');
                      } else {
                          // Display an error message
                          $('#cartMessage').text('Error updating quantity');
                      }
                  }
              });
          }
      });
  </script>

  </body>
</html>